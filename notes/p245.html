<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <meta charset="UTF-8">
  <base target="_blank">
  <title>Chen Cong</title>
  <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,700" rel="stylesheet">
  <link href="http://fonts.googleapis.com/css?family=Anonymous+Pro&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  <link href="/assets/solarized.css" rel="stylesheet" type="text/css">
</head>
<body>
<table id="header" class="full-width no-border">
<tr><td align="left">CCONG(4)</td><td align="center" id="title"></td><td align="right">CCONG(4)</td></tr>
</table>
<h1 id="softbound">SoftBound</h1>
<h2 id="problem">Problem</h2>
<ul>
<li>C/C++ lacks of bounds checking:</li>
<li>no spatial memory safety</li>
<li>leads to bugs and vulnerabilities.</li>
<li>OS and compilers provide only partial countermeasures:</li>
<li>guarding return address</li>
<li>address space randomization</li>
<li>non-executable stack</li>
<li>C/C++ is hard to retrofit (too flexible and low-level):</li>
<li>conflation of pointers and arrays</li>
<li>unchecked array indexing</li>
<li>arbitrary pointer arithmetic</li>
<li>pointers to the middle of objects</li>
<li>arbitrary casts</li>
<li>programmer-visible memory layout</li>
<li>structures with internal arrays</li>
<li>C/C++ is in widespread use, hard to replace:</li>
<li>Low level control of memory layout</li>
<li>Proximity to hardware</li>
<li>minimal runtime support</li>
<li>performance standard</li>
<li>OS, VM, runtimes, browsers.</li>
</ul>
<h2 id="existing-approaches">Existing approaches</h2>
<ul>
<li>Object-based: Sub-object violations</li>
<li>Pointer-based:
<ul>
<li>Bad compatibility: change memory layout.</li>
<li>High runtime overhead</li>
<li>Require non-trivial changes to src</li>
<li>Arbitrary casts</li>
<li>Complicate separate compilation.</li>
</ul></li>
<li>Hardbound: needs hardware support, which won't be available soon.</li>
</ul>
<h2 id="softbound-1">SoftBound</h2>
<ul>
<li>Gists:</li>
<li>Inspired by HardBound, but Software-only</li>
<li>Compile-time transformation, insert code for runtime propagation and checking of pointer bounds</li>
<li>Associate &quot;base&quot; and &quot;bound&quot; metadata with every pointer (not every object).</li>
<li>Record metadata in a disjoint facility.</li>
<li>Only access metadata via explicit table lookups on &quot;load&quot; and &quot;store&quot; of pointer values.</li>
<li>Intra-procedural transformation</li>
<li>Functions with pointer args or rets are extended with additional parameters for &quot;base&quot; and &quot;bound&quot; metadata.</li>
<li>Conceptually pointer-based, but disjoint metadata provides the compatibility of object-based</li>
<li>Features:</li>
<li>Src compatibility</li>
<li>Completeness</li>
<li><p>Separate compilation</p></li>
<li>Mechanism</li>
<li>Pointer checking and Metadata Propagation:
<ol style="list-style-type: decimal">
<li>pointer dereference:</li>
</ol>
<ul>
<li><code>*</code> operator</li>
<li><code>check(ptr, base, bound, size)</code> before dereference</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>creating pointers:</li>
</ol>
<ul>
<li>malloc, <code>&amp;</code> operator</li>
<li>set base and bound after creation</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Pointer arithmetic and assignment:</li>
</ol>
<ul>
<li>ptr+index, &amp;(ptr[index])</li>
<li>propagate base and bound after operation.</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li>Structure field access: covered by #3.</li>
<li>Optional narrowing of pointer bounds:</li>
</ol>
<ul>
<li><code>-&gt;</code> operator</li>
<li>Optional.</li>
<li>change base and bound after assignment.</li>
</ul></li>
<li>In-memory pointer metadata encoding:
<ul>
<li>Use a table to store metadata.</li>
<li>Lookup base and bound after load of a pointer value</li>
<li>Update base and bound after store of a pointer value</li>
</ul></li>
<li>Metadata propagation with function calls:
<ul>
<li>When args or ret is ptr: pass base and bound info along with them.</li>
</ul></li>
<li>Implementation:</li>
<li>Hash table: tag, base, bound</li>
<li><p>Shadow space: a large enough table</p></li>
</ul>
<h2 id="impact">Impact</h2>
<ul>
<li>Overhead:</li>
<li>For debugging and security-critical software: Full checking mode, 67%.</li>
<li>For end-user production code: Store-only checking mode, 22%.</li>
<li>Solves the problems of existing approaches:</li>
<li>Sub-object violations: conceptual pointer-based, optional narrowing of pointer bounds.</li>
<li>Change memory layout: disjoint metadata</li>
<li>High runtime overhead: Overhead of SoftBound is proved to be acceptable.</li>
<li>Require non-trivial changes to src: compile-time code insertion, no need to change src.</li>
<li>Arbitrary casts: check() function ensures the entire access is in bounds.</li>
<li>Complicate separate compilation: metadata propagation with function calls.</li>
<li>Needs hardware support: Software only</li>
</ul>
<table id="footer" class="full-width no-border">
<tr><td align="left">CCONG(4)</td><td align="center"><span id="date"></span></td><td align="right">CCONG(4)</td></tr>
</table>
</body>
<script>
document.getElementById("date").innerHTML = new Date().toISOString().slice(0, 10);
document.getElementById('title').innerHTML=document.getElementsByTagName("h1")[0].innerHTML;
document.title=document.getElementsByTagName("h1")[0].innerHTML;
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-67040327-1', 'auto'); ga('send', 'pageview');
</script>
</html>
</body>
</html>
